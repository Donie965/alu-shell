#!/usr/bin/env bash
#!/bin/bash

# Path to the PID file
PID_FILE="/var/run/my_process.pid"
PROCESS_NAME="manage_my_process"

start() {
    # Check if the process is already running
    if [[ -f "$PID_FILE" ]]; then
        echo "Process already running with PID $(cat $PID_FILE)"
        exit 1
    fi

    # Start the process and create the PID file
    echo "Starting $PROCESS_NAME..."
    ./manage_my_process &
    echo $! > "$PID_FILE"
    echo "$PROCESS_NAME started"
}

stop() {
    if [[ ! -f "$PID_FILE" ]]; then
        echo "Process not running."
        exit 1
    fi

    # Get the PID from the PID file and stop the process
    PID=$(cat "$PID_FILE")
    echo "Stopping process with PID $PID..."
    kill $PID
    rm -f "$PID_FILE"
    echo "$PROCESS_NAME stopped"
}

restart() {
    stop
    start
    echo "$PROCESS_NAME restarted"
}

# Check the argument passed to the script
case "$1" in
    start)
        start
        ;;
    stop)
        stop
        ;;
    restart)
        restart
        ;;
    *)
        echo "Usage: manage_my_process {start|stop|restart}"
        ;;
esac
